mysql
-- Bảng Người Dùng (Users)
CREATE TABLE Users (
  UserID INT AUTO_INCREMENT PRIMARY KEY,
  Username VARCHAR(255) NOT NULL,
  Password VARCHAR(255) NOT NULL,
  FullName VARCHAR(255) NOT NULL,
  Role ENUM('giáo viên', 'nhân viên phòng ban', 'quản trị viên') NOT NULL
);

-- Bảng Phòng Học (Classrooms)
CREATE TABLE Classrooms (
  ClassroomID INT AUTO_INCREMENT PRIMARY KEY,
  ClassroomName VARCHAR(255) NOT NULL,
  Location VARCHAR(255) NOT NULL,
  Description TEXT
);

-- Bảng Báo Cáo Sự Cố (Incident Reports)
CREATE TABLE IncidentReports (
  ReportID INT AUTO_INCREMENT PRIMARY KEY,
  UserID INT,
  ClassroomID INT,
  Description TEXT,
  ReportDate DATE NOT NULL,
  Status ENUM('đã gửi', 'đang xử lý', 'đã khắc phục', 'hoàn tất') NOT NULL,
  FOREIGN KEY (UserID) REFERENCES Users(UserID),
  FOREIGN KEY (ClassroomID) REFERENCES Classrooms(ClassroomID)
);

-- Bảng Nhân Viên Phòng Ban (RepairStaff)
CREATE TABLE RepairStaff (
  StaffID INT AUTO_INCREMENT PRIMARY KEY,
  FullName VARCHAR(255) NOT NULL,
  Position VARCHAR(255),
  UserID INT,
  FOREIGN KEY (UserID) REFERENCES Users(UserID)
);

-- Bảng Xác Nhận Sự Cố (Incident Confirmations)
CREATE TABLE IncidentConfirmations (
  ConfirmationID INT AUTO_INCREMENT PRIMARY KEY,
  ReportID INT,
  StaffID INT,
  ConfirmationDate DATE NOT NULL,
  IncidentDescription TEXT,
  ImagesAfterRepair LONGBLOB, -- Lưu ảnh sau khi sửa chữa
  Status ENUM('đã xác nhận', 'đang xử lý', 'đã khắc phục', 'hoàn tất') NOT NULL,
  FOREIGN KEY (ReportID) REFERENCES IncidentReports(ReportID),
  FOREIGN KEY (StaffID) REFERENCES RepairStaff(StaffID)
);

-- Bảng Đánh Giá Kết Quả (Evaluations)
CREATE TABLE Evaluations (
  EvaluationID INT AUTO_INCREMENT PRIMARY KEY,
  ReportID INT,
  UserID INT,
  Rating ENUM('Tốt', 'Khá', 'Kém') NOT NULL,
  Feedback TEXT,
  FOREIGN KEY (ReportID) REFERENCES IncidentReports(ReportID),
  FOREIGN KEY (UserID) REFERENCES Users(UserID)
);
